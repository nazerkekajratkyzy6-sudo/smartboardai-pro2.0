<!DOCTYPE html>
<html lang="kk">
<head>
    <meta charset="UTF-8">
    <title>“ö–∞–∑–∞“õ—à–∞ Word Search –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã</title>
    <style>
        body{
            font-family: system-ui, Arial, sans-serif;
            background:#f5f5ff;
            margin:0;
            padding:20px;
            display:flex;
            justify-content:center;
        }
        .container{
            max-width:1100px;
            width:100%;
            background:#ffffff;
            border-radius:18px;
            box-shadow:0 10px 25px rgba(0,0,0,0.12);
            padding:20px 24px 28px;
            display:flex;
            gap:24px;
        }
        h1{
            margin-top:0;
            font-size:24px;
            text-align:center;
            color:#1e3a8a;
        }
        .left, .right{
            flex:1;
        }
        label{
            font-size:14px;
            font-weight:600;
            color:#4b5563;
        }
        textarea{
            width:100%;
            height:180px;
            margin-top:6px;
            margin-bottom:12px;
            border-radius:12px;
            border:1px solid #cbd5f5;
            padding:10px;
            resize:vertical;
            font-size:14px;
        }
        input[type="number"]{
            width:80px;
            padding:6px 8px;
            border-radius:10px;
            border:1px solid #cbd5f5;
            margin-left:6px;
        }
        button{
            border:none;
            border-radius:999px;
            padding:8px 18px;
            font-size:14px;
            cursor:pointer;
            margin-top:10px;
            margin-right:8px;
            background:linear-gradient(135deg,#6366f1,#4f46e5);
            color:white;
            box-shadow:0 5px 15px rgba(79,70,229,0.35);
        }
        button.secondary{
            background:#e5e7eb;
            color:#111827;
            box-shadow:none;
        }
        .board{
            display:grid;
            gap:3px;
            margin-top:10px;
            user-select:none;
        }
        .cell{
            width:36px;
            height:36px;
            display:flex;
            align-items:center;
            justify-content:center;
            border-radius:8px;
            background:#eef2ff;
            color:#111827;
            font-weight:700;
            font-size:18px;
            cursor:pointer;
            transition:transform 0.05s, background 0.15s;
        }
        .cell:hover{
            transform:scale(1.05);
        }
        .cell.selected{
            background:#fbbf24;
        }
        .cell.found{
            background:#22c55e;
            color:white;
        }
        .words-list{
            margin-top:10px;
            padding:10px 12px;
            background:#f9fafb;
            border-radius:12px;
            border:1px solid #e5e7eb;
            font-size:14px;
        }
        .word-item.found{
            text-decoration:line-through;
            color:#16a34a;
        }
        .status{
            margin-top:8px;
            font-size:14px;
            min-height:20px;
        }
        .status.ok{color:#16a34a;}
        .status.err{color:#dc2626;}
    </style>
</head>
<body>
<div class="container">
    <div class="left">
        <h1>“ö–∞–∑–∞“õ—à–∞ ¬´–ñ–∞—Å—ã—Ä—ã–Ω —Å”©–∑–¥–µ—Ä¬ª –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã</h1>

        <label>–¢–∞“õ—ã—Ä—ã–ø—Ç—ã“õ —Å”©–∑–¥–µ—Ä (”ô—Ä –∂–æ–ª“ì–∞ –±—ñ—Ä —Å”©–∑, “õ–∞–∑–∞“õ—à–∞):</label>
        <textarea id="wordsInput">—Å–∫—Ä–∏–ø—Ç
—Å–ø—Ä–∞–π—Ç
–∂–æ–±–∞
–∫”©—Ä—ñ–Ω—ñ—Å
–ø—Ä–æ–≥—Ä–∞–º–º–∞
–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞
–º–æ–Ω–∏—Ç–æ—Ä</textarea>

        <div style="margin-top:4px;">
            <label>–¢–æ—Ä ”©–ª—à–µ–º—ñ: 
                <input type="number" id="sizeInput" value="12" min="6" max="18"> x 
                <span id="sizeLabel">12</span>
            </label>
        </div>

        <button id="generateBtn">–ì–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É</button>
        <button class="secondary" id="clearBtn">–¢–∞“£–¥–∞—É–¥—ã —Ç–∞–∑–∞–ª–∞—É</button>

        <div class="status" id="status"></div>

        <div class="words-list" id="wordsList"></div>
    </div>

    <div class="right">
        <label>–û–π—ã–Ω —Ç–æ—Ä—ã:</label>
        <div id="board" class="board"></div>
    </div>
</div>

<script>
/*
    “ö–∞–∑–∞“õ ”ô—Ä—ñ–ø—Ç–µ—Ä –∂–∏–Ω–∞“ì—ã ‚Äì “õ–∞–ª“ì–∞–Ω “±—è—à—ã“õ—Ç–∞—Ä–¥—ã —Ç–æ–ª—Ç—ã—Ä—É “Ø—à—ñ–Ω
*/
const KZ_LETTERS = "–ê”ò–ë–í–ì“í–î–ï–Å–ñ–ó–ò–Ü–ô–ö“ö–õ–ú–ù“¢–û”®–ü–†–°–¢–£“∞“Æ–§–•“∫–¶–ß–®–©–´–´–¨–≠–Æ–Ø";

/*
    –ì–ª–æ–±–∞–ª –∞–π–Ω—ã–º–∞–ª—ã–ª–∞—Ä
*/
let gridSize = 12;
let grid = [];
let placedWords = []; // {word, row, col, dx, dy}
let firstSelected = null;
let secondSelected = null;

const boardEl = document.getElementById("board");
const wordsListEl = document.getElementById("wordsList");
const statusEl = document.getElementById("status");

/*
    –ö”©–º–µ–∫—à—ñ —Ñ—É–Ω–∫—Ü–∏—è–ª–∞—Ä
*/
function randInt(max){ return Math.floor(Math.random()*max); }

function randomLetter(){
    return KZ_LETTERS[randInt(KZ_LETTERS.length)];
}

function clearStatus(){
    statusEl.textContent = "";
    statusEl.className = "status";
}

function setStatus(msg, type=""){
    statusEl.textContent = msg;
    statusEl.className = "status " + type;
}

/*
    –°”©–∑–¥–µ—Ä–¥—ñ –æ“õ—É
*/
function getWords(){
    const lines = document.getElementById("wordsInput").value
        .split(/\r?\n/)
        .map(w => w.trim())
        .filter(w => w.length>0);

    // –ñ–û“í–ê–†“í–´ –†–ï–ì–ò–°–¢–†, –±–æ—Å –æ—Ä—ã–Ω—Å—ã–∑
    return lines.map(w => w.toUpperCase().replace(/\s+/g,""));
}

/*
    –¢–æ—Ä–¥—ã –¥–∞–π—ã–Ω–¥–∞—É
*/
function initGrid(size){
    gridSize = size;
    grid = [];
    for(let r=0;r<size;r++){
        grid[r]=[];
        for(let c=0;c<size;c++){
            grid[r][c]="";
        }
    }
}

/*
    –°”©–∑–¥—ñ –±–µ–ª–≥—ñ–ª—ñ –±—ñ—Ä –æ—Ä—ã–Ω“ì–∞ –æ—Ä–Ω–∞–ª–∞—Å—Ç—ã—Ä—É“ì–∞ –±–æ–ª–∞ –º–∞?
*/
function canPlace(word, row, col, dx, dy){
    let r=row, c=col;
    for(let i=0;i<word.length;i++){
        if(r<0 || r>=gridSize || c<0 || c>=gridSize) return false;
        const existing = grid[r][c];
        const ch = word[i];
        if(existing !== "" && existing !== ch) return false;
        r+=dx; c+=dy;
    }
    return true;
}

function placeWord(word){
    // –º“Ø–º–∫—ñ–Ω –±–∞“ì—ã—Ç—Ç–∞—Ä: 8
    const directions = [
        [1,0],[-1,0],[0,1],[0,-1],
        [1,1],[1,-1],[-1,1],[-1,-1]
    ];
    // –±—ñ—Ä–Ω–µ—à–µ —Ä–µ—Ç —Ç—ã—Ä—ã—Å–∞–º—ã–∑
    for(let attempt=0; attempt<200; attempt++){
        const [dx,dy] = directions[randInt(directions.length)];
        const row = randInt(gridSize);
        const col = randInt(gridSize);
        if(canPlace(word, row, col, dx, dy)){
            let r=row, c=col;
            for(let i=0;i<word.length;i++){
                grid[r][c]=word[i];
                r+=dx; c+=dy;
            }
            placedWords.push({word,row,col,dx,dy,found:false});
            return true;
        }
    }
    return false;
}

/*
    –ë–∞—Ä–ª—ã“õ —Å”©–∑–¥–µ—Ä–¥—ñ –æ—Ä–Ω–∞–ª–∞—Å—Ç—ã—Ä—É
*/
function fillGrid(words){
    placedWords = [];
    for(const w of words){
        placeWord(w); // –æ—Ä–Ω–∞–ª–∞—Å–ø–∞–π “õ–∞–ª—Å–∞ ‚Äì –∂–∞–π “ì–∞–Ω–∞ ”©—Ç–∫—ñ–∑—ñ–ø –∂—ñ–±–µ—Ä–µ–º—ñ–∑
    }
    // “õ–∞–ª“ì–∞–Ω “±—è—à—ã“õ—Ç–∞—Ä–¥—ã –∫–µ–∑–¥–µ–π—Å–æ“õ ”ô—Ä—ñ–ø—Ç–µ—Ä–º–µ–Ω —Ç–æ–ª—Ç—ã—Ä–∞–º—ã–∑
    for(let r=0;r<gridSize;r++){
        for(let c=0;c<gridSize;c++){
            if(grid[r][c]==="") grid[r][c]=randomLetter();
        }
    }
}

/*
    –¢–æ—Ä–¥—ã —Å–∞–ª—É
*/
function renderBoard(){
    boardEl.innerHTML="";
    boardEl.style.gridTemplateColumns = `repeat(${gridSize}, 36px)`;
    for(let r=0;r<gridSize;r++){
        for(let c=0;c<gridSize;c++){
            const cell = document.createElement("div");
            cell.className="cell";
            cell.textContent = grid[r][c];
            cell.dataset.row = r;
            cell.dataset.col = c;
            cell.addEventListener("click", onCellClick);
            boardEl.appendChild(cell);
        }
    }
}

function renderWordsList(){
    wordsListEl.innerHTML = "<b>–°”©–∑–¥–µ—Ä:</b><br>";
    if(placedWords.length===0){
        wordsListEl.innerHTML += "<i>–¢–æ—Ä“ì–∞ –±—ñ—Ä–¥–µ-–±—ñ—Ä —Å”©–∑ —Ç–æ–ª—ã“õ —Å—ã–π–º–∞–¥—ã. –¢–æ—Ä ”©–ª—à–µ–º—ñ–Ω “Ø–ª–∫–µ–π—Ç—ñ“£—ñ–∑.</i>";
        return;
    }
    placedWords.forEach((obj, idx)=>{
        const span = document.createElement("span");
        span.textContent = (idx+1)+") "+obj.word;
        span.id = "word-item-"+idx;
        span.className = "word-item" + (obj.found ? " found":"");
        wordsListEl.appendChild(span);
        wordsListEl.appendChild(document.createElement("br"));
    });
}

/*
    “∞—è—à—ã“õ—Ç—ã –±–∞—Å—É –ª–æ–≥–∏–∫–∞—Å—ã (–±—ñ—Ä—ñ–Ω—à—ñ –∂”ô–Ω–µ –µ–∫—ñ–Ω—à—ñ)
*/
function onCellClick(e){
    const cell = e.currentTarget;
    const r = parseInt(cell.dataset.row);
    const c = parseInt(cell.dataset.col);

    if(firstSelected && secondSelected){
        clearSelection();
    }

    if(!firstSelected){
        firstSelected = {r,c,el:cell};
        cell.classList.add("selected");
        clearStatus();
    }else if(!secondSelected){
        // –µ–≥–µ—Ä —Å–æ–ª “±—è—à—ã“õ –±–æ–ª—Å–∞ ‚Äì —Ç–∞–∑–∞–ª–∞—É
        if(firstSelected.r===r && firstSelected.c===c){
            clearSelection();
            return;
        }
        secondSelected = {r,c,el:cell};
        cell.classList.add("selected");
        checkSelection();
    }
}

/*
    –¢–∞“£–¥–∞—É–¥—ã —Ç–∞–∑–∞–ª–∞—É
*/
function clearSelection(){
    const cells = document.querySelectorAll(".cell.selected");
    cells.forEach(c => c.classList.remove("selected"));
    firstSelected = null;
    secondSelected = null;
}

/*
    –ë—ñ—Ä—ñ–Ω—à—ñ –∂”ô–Ω–µ –µ–∫—ñ–Ω—à—ñ –Ω“Ø–∫—Ç–µ –∞—Ä“õ—ã–ª—ã —Å”©–∑ –±–∞—Ä –º–∞ ‚Äì —Ç–µ–∫—Å–µ—Ä—É
*/
function checkSelection(){
    if(!firstSelected || !secondSelected) return;

    let dx = secondSelected.r - firstSelected.r;
    let dy = secondSelected.c - firstSelected.c;

    // –±–∞“ì—ã—Ç—Ç—ã “õ–∞–ª—ã–ø“õ–∞ –∫–µ–ª—Ç—ñ—Ä—É (-1,0,1)
    dx = Math.sign(dx);
    dy = Math.sign(dy);

    // —Ç–µ–∫ —Ç“Ø–∑—É –±–∞“ì—ã—Ç—Ç–∞—Ä “ì–∞–Ω–∞
    if(dx===0 && dy===0){
        setStatus("–ë—ñ—Ä “±—è—à—ã“õ –∂–µ—Ç–∫—ñ–ª—ñ–∫—Å—ñ–∑, —Å”©–∑ —Ç“Ø–∑—É –±–∞“ì—ã—Ç—Ç–∞ –±–æ–ª—É—ã –∫–µ—Ä–µ–∫.", "err");
        clearSelection();
        return;
    }

    // –∂–æ–ª –±–æ–π—ã–º–µ–Ω ”ô—Ä—ñ–ø—Ç–µ—Ä–¥—ñ –∂–∏–Ω–∞—É
    let r = firstSelected.r;
    let c = firstSelected.c;
    let letters = "";
    const pathCells = [];

    while(r>=0 && r<gridSize && c>=0 && c<gridSize){
        letters += grid[r][c];
        pathCells.push({r,c});
        // “±–∑—ã–Ω–¥—ã“ì—ã –µ“£ “±–∑—ã–Ω —Å”©–∑–¥–µ–Ω 2 –µ—Å–µ –∞—Ä—Ç—ã“õ –±–æ–ª—Å–∞, “Ø–∑–µ —Å–∞–ª–∞–º—ã–∑
        if(letters.length > gridSize) break;
        r+=dx; c+=dy;
    }

    // –û—Å—ã –∂–æ–ª –±–æ–π—ã–Ω–¥–∞“ì—ã –∫–µ–∑ –∫–µ–ª–≥–µ–Ω –ø—Ä–µ—Ñ–∏–∫—Å “õ–æ–π—ã–ª“ì–∞–Ω —Å”©–∑–≥–µ —Ç–µ“£ –±–µ?
    let matched = null;
    placedWords.forEach((obj, idx)=>{
        if(matched) return;
        const w = obj.word;
        if(letters.startsWith(w) || letters.endsWith(w)){
            matched = {idx, word:w};
        }
    });

    if(!matched){
        setStatus("–ë“±–ª –±–∞“ì—ã—Ç—Ç–∞ –∂–∞—Å—ã—Ä—ã–Ω —Å”©–∑ –∂–æ“õ. “ö–∞–π—Ç–∞ –∫”©—Ä—ñ“£—ñ–∑.", "err");
        clearSelection();
        return;
    }

    // –°”©–∑ “±–∑—ã–Ω–¥—ã“ì—ã –±–æ–π—ã–Ω—à–∞ —Ç–µ–∫ –±—ñ—Ä—ñ–Ω—à—ñ –±”©–ª—ñ–≥—ñ–Ω –∞–ª–∞–º—ã–∑
    const length = matched.word.length;
    const usedCells = pathCells.slice(0,length);

    // –ñ–∞—Å—ã–ª–º–µ–Ω –±–æ—è—É
    usedCells.forEach(pos=>{
        const selector = `.cell[data-row="${pos.r}"][data-col="${pos.c}"]`;
        const el = document.querySelector(selector);
        if(el){
            el.classList.remove("selected");
            el.classList.add("found");
        }
    });

    placedWords[matched.idx].found = true;
    const itemEl = document.getElementById("word-item-"+matched.idx);
    if(itemEl) itemEl.classList.add("found");

    setStatus("–ñ–∞—Ä–∞–π—Å—ã“£! ¬´"+matched.word+"¬ª —Å”©–∑—ñ–Ω —Ç–∞–ø—Ç—ã“£!", "ok");

    clearSelection();

    // –ë–∞—Ä–ª—ã“õ —Å”©–∑ —Ç–∞–±—ã–ª–¥—ã –º–∞?
    if(placedWords.every(w => w.found)){
        setStatus("–ë–∞—Ä–ª—ã“õ —Å”©–∑ —Ç–∞–±—ã–ª–¥—ã! üëè", "ok");
    }
}

/*
    –ù–µ–≥—ñ–∑–≥—ñ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
*/
function generate(){
    clearStatus();
    const sizeInput = document.getElementById("sizeInput");
    let size = parseInt(sizeInput.value);
    if(isNaN(size) || size<6) size=6;
    if(size>18) size=18;
    sizeInput.value = size;
    document.getElementById("sizeLabel").textContent = size;

    const words = getWords();
    if(words.length===0){
        setStatus("–ö–µ–º—ñ–Ω–¥–µ –±—ñ—Ä —Å”©–∑ –µ–Ω–≥—ñ–∑—ñ“£—ñ–∑.", "err");
        return;
    }

    initGrid(size);
    fillGrid(words);
    renderBoard();
    renderWordsList();
}

/*
    –¢–∞–∑–∞–ª–∞—É –±–∞—Ç—ã—Ä–º–∞—Å—ã
*/
document.getElementById("clearBtn").addEventListener("click", ()=>{
    clearSelection();
    clearStatus();
});

/*
    –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–∞—Ç—ã—Ä–º–∞—Å—ã
*/
document.getElementById("generateBtn").addEventListener("click", generate);

/*
    –ë–µ—Ç—Ç—ñ –∞—à“õ–∞–Ω–¥–∞ –±—ñ—Ä–¥–µ–Ω –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞–ø “õ–æ—è–º—ã–∑
*/
generate();
</script>
</body>
</html>
