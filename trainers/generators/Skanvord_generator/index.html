<!DOCTYPE html>
<html lang="kk">
<head>
<meta charset="UTF-8">
<title>“ö–∞–∑–∞“õ—à–∞ —Å–∫–∞–Ω–≤–æ—Ä–¥ / —Å”©–∑–∂“±–º–±–∞“õ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã</title>
<style>
  body{
    margin:0;
    font-family:system-ui, Arial, sans-serif;
    background:#f7f7fb;
    color:#222;
    padding:16px;
  }
  h1{
    text-align:center;
    margin-top:0;
    margin-bottom:12px;
  }
  .container{
    max-width:1000px;
    margin:0 auto;
    background:#ffffff;
    border-radius:12px;
    padding:16px 18px 20px;
    box-shadow:0 4px 12px rgba(0,0,0,0.12);
  }
  textarea{
    width:100%;
    min-height:90px;
    resize:vertical;
    padding:8px;
    border-radius:8px;
    border:1px solid #ccc;
    font-family:inherit;
  }
  label{font-weight:600;}
  button{
    padding:8px 14px;
    margin-top:8px;
    margin-right:8px;
    border-radius:8px;
    border:none;
    cursor:pointer;
    background:#ffb74d;
    font-weight:600;
  }
  button:hover{background:#ffa726;}
  button:disabled{background:#ddd;cursor:default;}
  .grid-wrapper{
    overflow-x:auto;
    margin-top:14px;
  }
  table{
    border-collapse:collapse;
    margin:0 auto;
  }
  td{
    width:26px;
    height:26px;
    border:1px solid #999;
    text-align:center;
    vertical-align:middle;
    font-weight:bold;
    font-size:16px;
  }
  td.block{
    background:#e0e0e0;
  }
  td.empty{
    background:#ffffff;
  }
  .section-title{
    font-weight:700;
    margin-top:16px;
    margin-bottom:4px;
  }
  #clueList{
    margin-top:4px;
  }
  #textOutput{
    width:100%;
    min-height:70px;
    padding:6px;
    border-radius:8px;
    border:1px solid #ccc;
    font-family:monospace;
    font-size:13px;
    white-space:pre;
  }
  small{color:#555;}
</style>
</head>
<body>

<div class="container">
  <h1>“ö–∞–∑–∞“õ—à–∞ —Å–∫–∞–Ω–≤–æ—Ä–¥ / —Å”©–∑–∂“±–º–±–∞“õ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ã</h1>

  <label for="sourceText">1) –°”©–∑–¥–µ—Ä –º–µ–Ω —Å“±—Ä–∞“õ—Ç–∞—Ä–¥—ã –µ–Ω–≥—ñ–∑:</label>
  <small><br>”ò—Ä –∂–æ–ª–¥–∞: <b>—Å”©–∑ - —Å“±—Ä–∞“õ</b> (–Ω–µ–º–µ—Å–µ —Å”©–∑ : —Å“±—Ä–∞“õ). –ú—ã—Å–∞–ª—ã:<br>
  –º–µ–∫—Ç–µ–ø - –ë—ñ–ª—ñ–º –∞–ª–∞—Ç—ã–Ω –æ—Ä—ã–Ω<br>
  –∞–ª–º–∞ - “ö—ã–∑—ã–ª –Ω–µ–º–µ—Å–µ –∂–∞—Å—ã–ª –∂–µ–º—ñ—Å</small>

  <textarea id="sourceText" placeholder="–º–µ–∫—Ç–µ–ø - –ë—ñ–ª—ñ–º –∞–ª–∞—Ç—ã–Ω –æ—Ä—ã–Ω
–∞–ª–º–∞ - “ö—ã–∑—ã–ª –Ω–µ–º–µ—Å–µ –∂–∞—Å—ã–ª –∂–µ–º—ñ—Å
–ê—Å—Ç–∞–Ω–∞ - “ö–∞–∑–∞“õ—Å—Ç–∞–Ω –∞—Å—Ç–∞–Ω–∞—Å—ã"></textarea>

  <div style="margin-top:8px;">
    <label for="size">–¢–æ—Ä ”©–ª—à–µ–º—ñ:</label>
    <select id="size">
      <option value="15">15 x 15</option>
      <option value="17">17 x 17</option>
      <option value="19">19 x 19</option>
      <option value="21">21 x 21</option>
    </select>
  </div>

  <button onclick="generateScanword()">–°–∫–∞–Ω–≤–æ—Ä–¥ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É</button>
  <button id="copyBtn" onclick="copyText()" disabled>–ö”©—à—ñ—Ä—É (–º”ô—Ç—ñ–Ω)</button>

  <div class="section-title">2) –¢–æ—Ä–∫”©–∑–¥–µ—Ä:</div>
  <div class="grid-wrapper">
    <div id="gridArea"><small>–ê–ª–¥—ã–º–µ–Ω —Å”©–∑–¥–µ—Ä –º–µ–Ω —Å“±—Ä–∞“õ—Ç–∞—Ä–¥—ã –µ–Ω–≥—ñ–∑—ñ–ø, ¬´–≥–µ–Ω–µ—Ä–∞—Ü–∏—è–ª–∞—É¬ª –±–∞—Ç—ã—Ä–º–∞—Å—ã–Ω –±–∞—Å.</small></div>
  </div>

  <div class="section-title">3) –°“±—Ä–∞“õ—Ç–∞—Ä —Ç—ñ–∑—ñ–º—ñ:</div>
  <div id="clueList"><small>–ü—É—Å—Ç–æ.</small></div>

  <div class="section-title">4) –ú”ô—Ç—ñ–Ω —Ç“Ø—Ä—ñ–Ω–¥–µ–≥—ñ –Ω“±—Å“õ–∞—Å—ã (–∫”©—à—ñ—Ä—ñ–ø “õ–æ—é“ì–∞ —ã“£“ì–∞–π–ª—ã):</div>
  <textarea id="textOutput" readonly placeholder="–ú“±–Ω–¥–∞ –º”ô—Ç—ñ–Ω–¥—ñ–∫ —Å–∫–∞–Ω–≤–æ—Ä–¥ –ø–∞–π–¥–∞ –±–æ–ª–∞–¥—ã"></textarea>
</div>

<script>
// --- –ö”©–º–µ–∫—à—ñ: –º”ô—Ç—ñ–Ω–¥—ñ –ø–∞—Ä—Å–∏–Ω–≥ (—Å”©–∑ - —Å“±—Ä–∞“õ) ---
function parseInput(text){
  const lines = text.split(/\r?\n/).map(l => l.trim()).filter(l => l.length > 0);
  const result = [];
  for(const line of lines){
    let word = "";
    let clue = "";
    if(line.includes("-")){
      const parts = line.split("-");
      word = parts[0].trim();
      clue = parts.slice(1).join("-").trim();
    } else if(line.includes(":")){
      const parts = line.split(":");
      word = parts[0].trim();
      clue = parts.slice(1).join(":").trim();
    } else {
      // –µ–≥–µ—Ä –±”©–ª—ñ–Ω–±–µ—Å–µ, —Ç–µ–∫ —Å”©–∑, —Å“±—Ä–∞“õ—Ç—ã –±–æ—Å “õ–∞–ª–¥—ã—Ä–∞–º—ã–∑
      word = line.trim();
      clue = "";
    }
    if(word){
      result.push({word, clue});
    }
  }
  return result;
}

// --- “ö–∞–∑–∞“õ—à–∞ ”ô—Ä—ñ–ø—Ç–µ—Ä–¥—ñ ¬´–∂–∞—É–∞–ø¬ª —Ñ–æ—Ä–º–∞—Ç—ã–Ω–∞ –∫–µ–ª—Ç—ñ—Ä—É (–±–∞—Å ”ô—Ä—ñ–ø, –±–æ—Å –æ—Ä—ã–Ω—Å—ã–∑) ---
function normalizeAnswer(str){
  return str
    .toUpperCase()
    .replace(/[^A-Z–ê-–Ø”ò–Ü“¢“í“Æ“∞“ö”®“∫0-9]/g, ""); // —Ç–µ–∫ ”ô—Ä—ñ–ø/—Å–∞–Ω
}

// --- –ë–æ—Å —Ç–æ—Ä –∂–∞—Å–∞—É ---
function makeEmptyGrid(size){
  const grid = [];
  for(let r=0; r<size; r++){
    const row = [];
    for(let c=0; c<size; c++){
      row.push(""); // –±–æ—Å
    }
    grid.push(row);
  }
  return grid;
}

// --- –°”©–∑–¥—ñ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å “õ–æ—é“ì–∞ —Ç–∞–ª–ø—ã–Ω—ã—Å ---
function tryPlaceHorizontal(grid, answer, row, col){
  const n = grid.length;
  if(col + answer.length > n) return false;
  for(let i=0; i<answer.length; i++){
    const cell = grid[row][col + i];
    if(cell !== "" && cell !== answer[i]) return false;
  }
  for(let i=0; i<answer.length; i++){
    grid[row][col + i] = answer[i];
  }
  return true;
}

// --- –°”©–∑–¥—ñ –≤–µ—Ä—Ç–∏–∫–∞–ª—å “õ–æ—é“ì–∞ —Ç–∞–ª–ø—ã–Ω—ã—Å ---
function tryPlaceVertical(grid, answer, row, col){
  const n = grid.length;
  if(row + answer.length > n) return false;
  for(let i=0; i<answer.length; i++){
    const cell = grid[row + i][col];
    if(cell !== "" && cell !== answer[i]) return false;
  }
  for(let i=0; i<answer.length; i++){
    grid[row + i][col] = answer[i];
  }
  return true;
}

// --- –ë–∞—Ä —Å”©–∑–¥–µ—Ä–º–µ–Ω “õ–∏—ã–ª—ã—Å—Ç—ã—Ä—ã–ø “õ–æ—é“ì–∞ —Ç—ã—Ä—ã—Å—É ---
function placeWithCrossing(grid, answer){
  const n = grid.length;
  // ”ò—Ä ”ô—Ä—ñ–ø –±–æ–π—ã–Ω—à–∞, —Ç–æ—Ä–¥–∞“ì—ã —Å–æ–ª ”ô—Ä—ñ–ø—Ç—ñ —ñ–∑–¥–µ–π–º—ñ–∑
  for(let i=0; i<answer.length; i++){
    const ch = answer[i];
    for(let r=0; r<n; r++){
      for(let c=0; c<n; c++){
        if(grid[r][c] === ch){
          // –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å “õ–æ—é“ì–∞ —Ç—ã—Ä—ã—Å–∞–º—ã–∑ (“õ–∏—ã–ª—ã—Å–∞—Ç—ã–Ω –Ω“Ø–∫—Ç–µ)
          const startCol = c - i;
          if(startCol >= 0 && startCol + answer.length <= n){
            let ok = true;
            for(let k=0; k<answer.length; k++){
              const cell = grid[r][startCol + k];
              if(cell !== "" && cell !== answer[k]){ ok=false; break; }
            }
            if(ok){
              for(let k=0; k<answer.length; k++){
                grid[r][startCol + k] = answer[k];
              }
              return true;
            }
          }
          // –≤–µ—Ä—Ç–∏–∫–∞–ª—å “õ–æ—é“ì–∞ —Ç—ã—Ä—ã—Å–∞–º—ã–∑
          const startRow = r - i;
          if(startRow >= 0 && startRow + answer.length <= n){
            let ok2 = true;
            for(let k=0; k<answer.length; k++){
              const cell = grid[startRow + k][c];
              if(cell !== "" && cell !== answer[k]){ ok2=false; break; }
            }
            if(ok2){
              for(let k=0; k<answer.length; k++){
                grid[startRow + k][c] = answer[k];
              }
              return true;
            }
          }
        }
      }
    }
  }
  return false;
}

// --- –ù–µ–≥—ñ–∑–≥—ñ –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ---
function generateScanword(){
  const src = document.getElementById("sourceText").value.trim();
  const size = parseInt(document.getElementById("size").value,10);
  const gridArea = document.getElementById("gridArea");
  const clueList = document.getElementById("clueList");
  const textOutput = document.getElementById("textOutput");
  const copyBtn = document.getElementById("copyBtn");

  if(!src){
    gridArea.innerHTML = "<small>–°”©–∑–¥–µ—Ä –µ–Ω–≥—ñ–∑—ñ–ª–º–µ–≥–µ–Ω.</small>";
    clueList.innerHTML = "<small>–°“±—Ä–∞“õ—Ç–∞—Ä –∂–æ“õ.</small>";
    textOutput.value = "";
    copyBtn.disabled = true;
    return;
  }

  const items = parseInput(src);
  if(items.length === 0){
    gridArea.innerHTML = "<small>–ñ–∞—Ä–∞–º–¥—ã –∂–æ–ª —Ç–∞–±—ã–ª–º–∞–¥—ã. –§–æ—Ä–º–∞—Ç: ¬´—Å”©–∑ - —Å“±—Ä–∞“õ¬ª.</small>";
    clueList.innerHTML = "<small>–°“±—Ä–∞“õ—Ç–∞—Ä –∂–æ“õ.</small>";
    textOutput.value = "";
    copyBtn.disabled = true;
    return;
  }

  // normalize answers
  const words = items.map(it => ({
    answer: normalizeAnswer(it.word),
    clue: it.clue,
    raw: it.word
  })).filter(w => w.answer.length > 0);

  if(words.length === 0){
    gridArea.innerHTML = "<small>”ò—Ä—ñ–ø—Ç–µ—Ä—ñ –∂–æ“õ –∂–æ–ª–¥–∞—Ä.</small>";
    clueList.innerHTML = "<small>–°“±—Ä–∞“õ—Ç–∞—Ä –∂–æ“õ.</small>";
    textOutput.value = "";
    copyBtn.disabled = true;
    return;
  }

  // –µ“£ “±–∑—ã–Ω —Å”©–∑–¥—ñ –±—ñ—Ä—ñ–Ω—à—ñ “õ–æ—è–º—ã–∑
  words.sort((a,b) => b.answer.length - a.answer.length);

  const grid = makeEmptyGrid(size);
  const midRow = Math.floor(size/2);
  const startCol = Math.max(0, Math.floor((size - words[0].answer.length)/2));
  tryPlaceHorizontal(grid, words[0].answer, midRow, startCol);

  // “õ–∞–ª“ì–∞–Ω–¥–∞—Ä—ã–Ω “õ–∏—ã–ª—ã—Å—Ç—ã—Ä—É“ì–∞ —Ç—ã—Ä—ã—Å–∞–º—ã–∑, –±–æ–ª–º–∞—Å–∞ –±–∞—Å“õ–∞ –∂–æ–ª/–±–∞“ì–∞–Ω“ì–∞
  for(let w = 1; w < words.length; w++){
    const ans = words[w].answer;
    let placed = placeWithCrossing(grid, ans);
    if(!placed){
      // –±–æ—Å –æ—Ä—ã–Ω —ñ–∑–¥–µ–ø, –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å “õ–æ–π—ã–ø –∫”©—Ä–µ–º—ñ–∑
      outer:
      for(let r=0; r<size; r++){
        for(let c=0; c<size; c++){
          if(tryPlaceHorizontal(grid, ans, r, c)){
            placed = true;
            break outer;
          }
          if(tryPlaceVertical(grid, ans, r, c)){
            placed = true;
            break outer;
          }
        }
      }
    }
  }

  // HTML —Ç–æ—Ä–¥—ã —Å–∞–ª—É
  const table = document.createElement("table");
  for(let r=0; r<size; r++){
    const tr = document.createElement("tr");
    for(let c=0; c<size; c++){
      const td = document.createElement("td");
      if(grid[r][c] === ""){
        td.className = "block";
        td.innerHTML = "&nbsp;";
      }else{
        td.className = "empty";
        td.textContent = grid[r][c];
      }
      tr.appendChild(td);
    }
    table.appendChild(tr);
  }
  gridArea.innerHTML = "";
  gridArea.appendChild(table);

  // —Å“±—Ä–∞“õ—Ç–∞—Ä —Ç—ñ–∑—ñ–º—ñ
  const ul = document.createElement("ol");
  for(const it of words){
    const li = document.createElement("li");
    const clue = it.clue ? it.clue : "(—Å“±—Ä–∞“õ –∂–∞–∑—ã–ª–º–∞“ì–∞–Ω)";
    li.textContent = it.raw + " ‚Äî " + clue;
    ul.appendChild(li);
  }
  clueList.innerHTML = "";
  clueList.appendChild(ul);

  // –º”ô—Ç—ñ–Ω–¥—ñ–∫ –Ω“±—Å“õ–∞ (ASCII)
  let textGrid = "";
  for(let r=0; r<size; r++){
    let line = "";
    for(let c=0; c<size; c++){
      line += (grid[r][c] === "" ? "#" : grid[r][c]);
    }
    textGrid += line + "\n";
  }
  textGrid += "\n–°“±—Ä–∞“õ—Ç–∞—Ä:\n";
  words.forEach((w,i)=>{
    textGrid += (i+1)+") "+w.raw+" ‚Äî "+(w.clue || "")+"\n";
  });

  textOutput.value = textGrid;
  copyBtn.disabled = false;
}

// –ö”©—à—ñ—Ä—É —Ñ—É–Ω–∫—Ü–∏—è—Å—ã
function copyText(){
  const textOutput = document.getElementById("textOutput");
  const copyBtn = document.getElementById("copyBtn");
  if(!textOutput.value){
    return;
  }
  if(navigator.clipboard && navigator.clipboard.writeText){
    navigator.clipboard.writeText(textOutput.value)
      .then(()=>{
        copyBtn.textContent = "–ö”©—à—ñ—Ä—ñ–ª–¥—ñ ‚úÖ";
        setTimeout(()=>{copyBtn.textContent = "–ö”©—à—ñ—Ä—É (–º”ô—Ç—ñ–Ω)";},1500);
      })
      .catch(()=>{
        // –µ–≥–µ—Ä clipboard –∂“±–º—ã—Å —ñ—Å—Ç–µ–º–µ—Å–µ ‚Äì –∫–ª–∞—Å—Å–∏–∫–∞–ª—ã“õ select+copy
        textOutput.select();
        document.execCommand("copy");
        copyBtn.textContent = "–ö”©—à—ñ—Ä—ñ–ª–¥—ñ ‚úÖ";
        setTimeout(()=>{copyBtn.textContent = "–ö”©—à—ñ—Ä—É (–º”ô—Ç—ñ–Ω)";},1500);
      });
  } else {
    textOutput.select();
    document.execCommand("copy");
    copyBtn.textContent = "–ö”©—à—ñ—Ä—ñ–ª–¥—ñ ‚úÖ";
    setTimeout(()=>{copyBtn.textContent = "–ö”©—à—ñ—Ä—É (–º”ô—Ç—ñ–Ω)";},1500);
  }
}
</script>
<!-- üî• –ê–≤—Ç–æ—Ä–ª—ã“õ –±–µ–ª–≥—ñ -->
<div style="
    margin-top:32px;
    text-align:center;
    padding:12px 0;
    font-size:18px;
    color:#555;
    border-top:2px solid #e5e7eb;
">
    AI-Pedagogy Tools by <b>Nazerke Kairatkyzy</b>
</div>

</body>
</html>
