<!DOCTYPE html>
<html lang="kk">
<head>
<meta charset="UTF-8">
<title>Sequence Builder PRO – Реттілік құрастыр</title>
<style>
    body{
        margin:0;
        padding:20px;
        background:#eef2ff;
        font-family:system-ui,Arial;
        display:flex;
        justify-content:center;
    }
    .container{
        max-width:900px;
        width:100%;
        background:white;
        padding:26px 30px;
        border-radius:18px;
        box-shadow:0 10px 25px rgba(0,0,0,0.18);
    }
    h1{
        text-align:center;
        color:#1e3a8a;
        margin-bottom:16px;
    }
    textarea{
        width:100%;
        height:140px;
        border-radius:12px;
        border:1px solid #cbd5ff;
        padding:10px;
        font-size:14px;
        margin-bottom:10px;
    }
    button{
        border:none;
        border-radius:999px;
        padding:10px 22px;
        background:linear-gradient(135deg,#6366f1,#4f46e5);
        color:white;
        cursor:pointer;
        font-size:15px;
        margin-bottom:14px;
        box-shadow:0 4px 12px rgba(79,70,229,0.35);
    }

    .step-box{
        display:flex;
        flex-direction:column;
        gap:12px;
        margin-top:16px;
    }
    .step{
        background:#eef2ff;
        padding:12px 14px;
        border-radius:12px;
        border:1px solid #cbd5ff;
        font-size:18px;
        cursor:grab;
        transition:0.15s;
    }
    .step:hover{
        transform:scale(1.02);
        border-color:#6366f1;
    }
    .drag-over{
        background:#e0e7ff;
        border-color:#6366f1;
    }
    .correct{
        background:#22c55e !important;
        color:white !important;
        border-color:#22c55e !important;
    }
    .wrong{
        background:#ef4444 !important;
        color:white !important;
        border-color:#ef4444 !important;
    }

    .finish{
        margin-top:20px;
        font-size:22px;
        font-weight:600;
        color:#1e40af;
        text-align:center;
    }

    .author{
        margin-top:26px;
        text-align:center;
        font-size:14px;
        color:#777;
    }
</style>
</head>
<body>

<div class="container">

<h1>Sequence Builder PRO – Реттілік құрастыр</h1>

<label>Қадамдар (әр жолға бір қадам):</label>
<textarea id="stepsArea">1. Жарық көзінен шығады
2. Түзу сызық бойымен таралады
3. Көздің тор қабатына түседі
4. Ми оны бейне ретінде өңдейді</textarea>

<button onclick="startSequence()">Ойынды бастау</button>

<div id="gameBox"></div>

<div class="author">
    © Pedagogy Tools • Author: <b>Nazerke Kairatkyzy</b>
</div>

</div>

<script>
let correctOrder = [];
let currentOrder = [];

function startSequence(){
    const txt = document.getElementById("stepsArea").value.trim();
    correctOrder = txt.split(/\r?\n/).filter(x=>x.trim().length>0);

    if(correctOrder.length < 2){
        alert("Кемінде 2 қадам керек!");
        return;
    }

    // араластырамыз
    currentOrder = [...correctOrder];
    shuffle(currentOrder);

    renderSequence();
}

function shuffle(arr){
    for(let i=arr.length-1;i>0;i--){
        const j = Math.floor(Math.random() * (i+1));
        [arr[i],arr[j]] = [arr[j],arr[i]];
    }
}

function renderSequence(){
    const box = document.getElementById("gameBox");
    let html = `<div class="step-box" id="stepBox">`;

    currentOrder.forEach((step, index)=>{
        html += `
            <div class="step"
                 draggable="true"
                 data-index="${index}"
                 ondragstart="dragStart(event)"
                 ondragover="dragOver(event)"
                 ondrop="dropStep(event)">
                ${step}
            </div>`;
    });

    html += `</div>
             <button onclick="checkSequence()">Тексеру</button>
             <div id="finishBox"></div>`;

    box.innerHTML = html;
}

let dragSrcIndex = null;

function dragStart(e){
    dragSrcIndex = e.target.dataset.index;
}

function dragOver(e){
    e.preventDefault();
    e.target.classList.add("drag-over");
}

function dropStep(e){
    e.preventDefault();
    const targetIndex = e.target.dataset.index;

    e.target.classList.remove("drag-over");

    // орын ауыстыру
    [currentOrder[dragSrcIndex], currentOrder[targetIndex]] =
        [currentOrder[targetIndex], currentOrder[dragSrcIndex]];

    renderSequence();
}

function checkSequence(){
    const steps = document.querySelectorAll(".step");
    let correctCount = 0;

    steps.forEach((el, i)=>{
        if(currentOrder[i] === correctOrder[i]){
            el.classList.add("correct");
            correctCount++;
        } else {
            el.classList.add("wrong");
        }
    });

    const finish = document.getElementById("finishBox");
    finish.innerHTML = `
        <div class="finish">
            Дұрыс реттілік: <b>${correctCount}</b> / ${correctOrder.length}
        </div>
    `;
}
</script>

</body>
</html>
